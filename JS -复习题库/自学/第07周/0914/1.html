<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>AJAX</title>
</head>

<body>
	<script>
		/* let xhr = new XMLHttpRequest;
		// console.log(xhr.readyState); //=>0
		xhr.open('GET', 'json/data.json');
		// console.log(xhr.readyState); //=>1
		xhr.onreadystatechange = function () {
			// console.log(xhr.readyState); //=>2 3 4
			if (!/^(2|3)\d{2}$/.test(xhr.status)) return;
			if (xhr.readyState === 2) {
				//=>获取响应头信息
				//获取的服务器时间是标准的日期格式对象（GMT格林尼治时间）
				//new Date()能把格林尼治时间转换为北京时间
				let serverTime = xhr.getResponseHeader('Date');
				// console.log(new Date(serverTime));
			}
			if (xhr.readyState === 4) {
				//=>获取响应主体信息：我们一般用responseText，因为服务器返回的信息一般都是JSON格式的字符串，如果返回的是XML格式，我们用responseXML...
				// xhr.responseXML
				// xhr.response
				// xhr.responseType
				// console.log(xhr.responseText);
			}
		}
		xhr.send(null); */
	</script>

	<script>
		/* let xhr = new XMLHttpRequest;
		// xhr.timeout = 10; //=>设置AJAX等待时间，超过这个时间算AJAX延迟
		// xhr.ontimeout = function () {
		// 	console.log('请求超时~~');
		// 	xhr.abort(); //=>手动中断AJAX的请求
		// }
		// xhr.withCredentials = true; //=>在跨域请求中是否允许携带证书（携带COOKIE）
		xhr.open('GET', 'json/data.json');
		//=>设置请求头信息
		// xhr.setRequestHeader('AAA', encodeURIComponent('珠峰培训'));
		// Uncaught TypeError: Failed to execute 'setRequestHeader' on 'XMLHttpRequest': Value is not a valid ByteString. 设置的请求头信息值不能是中文
		xhr.onreadystatechange = function () {
			if (!/^(2|3)\d{2}$/.test(xhr.status)) return;
			if (xhr.readyState === 4) {
				console.log(xhr.responseText);
			}
		}
		xhr.send(null); */
	</script>

	<!-- 同步异步 -->
	<script>
		//=>AJAX任务的异步
		/* let xhr = new XMLHttpRequest;
		xhr.open('GET', 'json/data.json');
		//=>设置事件绑定之前状态1
		xhr.onreadystatechange = function () {
			console.log(xhr.readyState); //=>2 3 4
		}
		xhr.send(null); */

		/* let xhr = new XMLHttpRequest;
		xhr.open('GET', 'json/data.json');
		xhr.send(null);
		xhr.onreadystatechange = function () {
			console.log(xhr.readyState); //=>2 3 4
		} */


		//=>AJAX的同步
		/* let xhr = new XMLHttpRequest;
		xhr.open('GET', 'json/data.json', false);
		xhr.onreadystatechange = function () {
			console.log(xhr.readyState); //=>4 使用AJAX同步编程，不能在状态码为2的时候获取到响应头的信息，但是状态码为4的时候也是可以获取到头和主体信息
		}
		xhr.send(null); */

		/* let xhr = new XMLHttpRequest;
		xhr.open('GET', 'json/data.json', false);
		xhr.send(null);//=>执行后，只有状态码为4才会继续处理下面的代码
		//=>状态码为4的时候绑定的，而状态不会在变了，所以方法不会执行
		xhr.onreadystatechange = function () {
			console.log(xhr.readyState);
		} */

		// API：Application Programming Interface 凡是可被别人调用，并且给予反馈结果的都可以被称之为API接口
	</script>

	<script>
		/* let xhr = new XMLHttpRequest;
		xhr.open('GET', 'http://yapi.demo.qunar.com/mock/95100/project/list?lx=1');
		xhr.onreadystatechange = function () {
			if (!/^(2|3)\d{2}$/.test(xhr.status)) return;
			if (xhr.readyState === 4) {
				console.log(xhr.responseText);
			}
		}
		xhr.send(null); */
	</script>
</body>

</html>